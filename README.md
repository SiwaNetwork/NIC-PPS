# Intel IGC PPS Driver Setup

Набор скриптов для установки драйвера Intel IGC с поддержкой PPS (Pulse Per Second) и настройки PPS сигналов.

## Описание скриптов

1. **install_igc_pps.sh** - Основной скрипт установки драйвера
2. **configure_pps.sh** - Интерактивный скрипт настройки PPS с меню
3. **quick_pps_setup.sh** - Быстрая настройка PPS выхода

## Установка

### Шаг 1: Установка драйвера

```bash
chmod +x install_igc_pps.sh
sudo ./install_igc_pps.sh
```

Скрипт автоматически:
- Скачает драйвер с поддержкой PPS
- Удалит старую версию (если установлена)
- Соберёт и установит новый драйвер через DKMS
- Заменит модуль ядра
- Обновит initramfs

### Шаг 2: Перезагрузка

После успешной установки выполните:

```bash
sudo reboot
```

### Шаг 3: Настройка PPS

После перезагрузки выберите один из вариантов:

#### Вариант А: Интерактивная настройка (рекомендуется)

```bash
chmod +x configure_pps.sh
sudo ./configure_pps.sh
```

Меню позволяет:
- Настроить PPS выход (SMA1)
- Настроить PPS вход (SMA2)
- Проверить работу PPS
- Посмотреть информацию о системе

#### Вариант Б: Быстрая настройка

```bash
chmod +x quick_pps_setup.sh
sudo ./quick_pps_setup.sh
```

Быстро настроит PPS выход на 1 Гц.

## Проверка установки

После перезагрузки проверьте драйвер:

```bash
modinfo igc | grep filename
ethtool -i enp3s0  # замените на ваш интерфейс
```

## Описание PPS

- **SMA1 (SDP0)** - PPS выход, генерирует сигнал 1PPS (1 импульс в секунду)
- **SMA2 (SDP1)** - PPS вход, принимает внешний PPS сигнал (например, от GPS)

## Требования

- Ubuntu/Debian Linux
- Сетевая карта Intel с чипом IGC (i225/i226)
- Права root для установки
- DKMS для сборки драйвера

## Устранение проблем

Если драйвер не загрузился после перезагрузки:

```bash
# Проверка загруженного модуля
lsmod | grep igc

# Ручная загрузка
sudo modprobe igc

# Проверка логов
dmesg | grep igc
```

## Дополнительные команды

Чтение PPS событий с входа:

```bash
sudo testptp -d /dev/ptp0 -e 10  # читает 10 событий
```

Изменение частоты PPS выхода:

```bash
# 10 Гц (100ms период)
sudo testptp -d /dev/ptp0 -p 100000000

# 0.5 Гц (2 секунды период)  
sudo testptp -d /dev/ptp0 -p 2000000000
```